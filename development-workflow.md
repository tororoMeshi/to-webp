# to-webp プロジェクト開発ワークフロー

## 開発からデプロイまでの流れ

### 1. コード開発・修正
- ソースコードを作成または修正する
- `src/` ディレクトリ内のRustコードを編集

### 2. コードの品質チェック
```bash
# format.sh を実行してフォーマットとチェックを行う
./format.sh
```

**format.sh の動作内容**:
1. `cargo fmt` でコードをフォーマット
2. `rust-check` コンテナでコードのチェックを実行
   - コンパイルエラーチェック
   - clippy による警告チェック

**注意**: すべてのエラーと警告を修正してから次のステップに進む

### 3. Dockerイメージのビルドとプッシュ
```bash
# DockerHubへのプッシュスクリプトを実行
./push_to_dockerhub.sh
```

**push_to_dockerhub.sh の動作内容**:
1. Dockerイメージのビルド
2. DockerHubへのプッシュ
   - タグ付き（日時またはバージョン）
   - latest タグ

### 4. GitHubへのプッシュ
```bash
# 新機能開発の場合
git checkout -b feature/機能名

# バグ修正の場合
git checkout -b fix/修正名

# 変更のステージングとコミット
git add 変更したファイル
git commit -m "Add: 新機能の追加" # プレフィックスに注意

# リモートにプッシュ
git push -u origin ブランチ名
```

**コミットメッセージの規則**:
- `Add:` - 新機能
- `Fix:` - バグ修正
- `Refactor:` - コード整理
- `Docs:` - ドキュメント更新
- `Test:` - テスト関連

### 5. プルリクエスト作成
- GitHubウェブインターフェースからPRを作成
- PRは詳細な説明を含め、レビュアーに割り当てる
- `main` ブランチへのマージはPRを通してのみ行う

## 重要なポイント

- **ローカルでのコンパイル/実行は行わない** - すべてコンテナ内で実行
- **コミット前にformat.shでチェック** - エラー/警告がないことを確認
- **DockerHub公開前に品質確認** - 正常に動作するイメージのみをプッシュ
- **小さな変更を頻繁にコミット** - 変更の追跡と理解を容易に
- **PRの粒度は小さく** - レビューを容易にするため

## 開発環境

- Docker - コンテナ化されたビルド・実行環境
- GitHub - ソースコード管理とコラボレーション
- DockerHub - コンテナイメージの配布

この開発フローに従うことで、高品質なコードを維持し、チーム全体での開発を効率化できます。